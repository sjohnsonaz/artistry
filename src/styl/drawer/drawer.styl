@require 'drawer-settings.styl';

$drawer-transition-duration = $drawer-fade-duration + $drawer-slide-duration;

.drawer-container {
    display: flex;
    flex-direction: row;

    .drawer {
        opacity: 1;
        visibility: visible;
        transition: none;
        top: auto;
        right: auto;
        bottom: auto;
        left: auto;

        & > .drawer-content {
            transition: none;
            transform: none;
            visibility: visible;
            box-shadow: none;
        }
    }
}

// TODO: Create z-index override to force on top
.drawer {
    display: block;
    position: fixed;
    top: 0;
    right: 0;
    bottom: 0;
    left: 0;
    z-index: $drawer-z-index;
    visibility: hidden;
    overflow-y: scroll;
    transition-property: visibility, overflow;
    transition-duration: $drawer-transition-duration, $drawer-transition-duration;
    will-change: visibility;

    &:before {
        content: '';
        display: block;
        position: fixed;
        top: 0;
        right: 0;
        bottom: 0;
        left: 0;
        background-color: $drawer-mask-background-color;
        opacity: 0;
        transition-property: opacity;
        transition-duration: ($drawer-transition-duration / 2);
        transition-delay: ($drawer-transition-duration / 2);
        will-change: opacity;
    }

    & > .drawer-scroller {
        position: absolute;
        overflow-y: hidden;
        top: 0;
        right: 0;
        bottom: 0;
        left: 0;

        & > .drawer-content {
            display: block;
            position: absolute;
            background-color: $drawer-background-color;
            padding: $drawer-padding;
            border: $drawer-border-width solid $drawer-border-color;
            border-radius: $drawer-border-radius;
            max-height: 100%;
            max-width: 100%;
            overflow: visible;
            box-shadow: $drawer-box-shadow;
            z-index: $drawer-z-index + 1;
            transition-property: transform;
            transition-duration: $drawer-transition-duration;
            transition-delay: 0s;
            clearfix();

            .drawer-top& {
                top: 0;
                left: 0;
                right: 0;
                transform: translateY(-200%);

                .drawer-full& {
                    bottom: 0;
                }
            }

            .drawer-right& {
                top: 0;
                right: 0;
                bottom: 0;
                transform: translateX(200%);

                .drawer-full& {
                    left: 0;
                }
            }

            .drawer-bottom& {
                right: 0;
                bottom: 0;
                left: 0;
                transform: translateY(200%);

                .drawer-full& {
                    top: 0;
                }
            }

            .drawer-left& {
                top: 0;
                bottom: 0;
                left: 0;
                transform: translateX(-200%);

                .drawer-full& {
                    right: 0;
                }
            }
        }
    }

    &.drawer-open {
        visibility: visible;

        & > .drawer-scroller {
            overflow-y: hidden;

            & > .drawer-content {
                transition-delay: $drawer-fade-duration;
                transform: none;
            }
        }

        &:before {
            opacity: 1;
            transition-duration: $drawer-fade-duration;
            transition-delay: 0s;
        }
    }
}

@keyframes overflow-y-scroll {
    from {
        overflow-y: hidden;
    }

    to {
        overflow-y: scroll;
    }
}